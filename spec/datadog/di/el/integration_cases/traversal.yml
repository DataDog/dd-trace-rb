- name: index into array
  ast:
    index:
      - ref: arr
      - 1
  compiled: "index(ref('arr'), (1))"

  eval:
    - locals:
        arr: [42, 43, 44]
      result: 43

    - name: index out of bounds
      locals:
        arr: [42]
      result:

    - name: target is not an array
      locals:
        arr:
          hello
      error: "Invalid argument for index: hello"

- name: index into hash
  ast:
    index:
      - ref: hash
      - x
  compiled: "index(ref('hash'), (\"x\"))"

  eval:
    - locals:
        hash:
          x: 43
      result: 43

    - name: key does not exist
      locals:
        hash:
          foo: 43
      result:

    - name: target is not a hash
      locals:
        hash:
          hello
      error: "Invalid argument for index: hello"

- name: getmember
  ast:
    getmember:
      - ref: var
      - ivar

  compiled: getmember(ref('var'), ("ivar"))

  eval:
    - locals:
        var: !ruby/object:ELTestIvarClass
          ivar: 50
      result: 50

    - name: ivar missing
      locals:
        var: !ruby/object:ELTestIvarClass
      # TODO raise exception?
      result:
