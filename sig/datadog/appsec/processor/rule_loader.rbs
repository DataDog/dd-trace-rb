module Datadog
  module AppSec
    class Processor
      module RuleLoader
        type ruleset = Symbol | String | File | StringIO | Hash[String, untyped]
        def self.load_rules: (ruleset: ruleset) -> ::Hash[untyped, untyped]?

        def self.load_data: (?ip_denylist: Array[String], ?user_id_denylist: Array[String]) -> Array[Hash[String, untyped]]

        private

        def self.denylist_data: (String id, Array[String] denylist) -> ::Hash[::String, untyped]
      end
    end
  end
end

